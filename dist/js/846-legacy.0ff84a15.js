(self["webpackJsonp_hoderSaas"]=self["webpackJsonp_hoderSaas"]||[]).push([[846],{90385:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=90385,e.exports=t},16817:function(e,t,r){var n={"./UserEditPage.vue":59491,"./user-components/product-role.vue":86346};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=16817},75846:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var n={};r.r(n);var i=function(){var e=this,t=e._self._c;return t("el-main",[t("BaseList",{attrs:{"menu-id":e.menuId,"fetch-method":e.fetchService,"menu-detail-method":e.getMenusDetail,"handle-resource":e.handleResource,"page-config":e.pageConfig}})],1)},o=[],a=r(93506),c=(r(41539),r(54747),r(33948),r(74916),r(15306),r(16817)),s={};c.keys().forEach((function(e){s[e.replace(/(^\.\/|\.vue$)/g,"")]=c(e).default}));var u=s,l=r(90385),d={};l.keys().forEach((function(e){d[e.replace(/(^\.\/|\.vue$)/g,"")]=l(e).default}));var p=d,f=(r(92222),r(99534)),m={clearLoginError:function(e){var t=this,r=e.row,n={userName:r.userName};(0,f.fI)(n).then((function(e){var i=e.data;if(!i)return t.$message.info("".concat(r.userName," 累计登录失败次数已经为 ").concat(i,",不需要重置！"));t.$confirm("".concat(r.userName," 累计登录失败次数为").concat(i,", 是否解锁（将该用户的登录失败次数重置为0）?"),"提示",{type:"warning"}).then((function(){(0,f.XY)(n,"解锁成功").then((function(){t.clearSelected()}))})).catch((function(){}))}))}},h=r(56414),g=r(65461),v={props:["menuId"],data:function(){return{handleResource:{pages:u,dialogs:p,todo:m,renderMethods:n.renderMethods},fetchService:h.Z,getMenusDetail:g.rZ}}},y={props:["menuId"],mixins:[v],components:{BaseList:a.D7},data:function(){return{pageConfig:{disabledSetHeight:!0}}}},b=y,w=r(1001),_=(0,w.Z)(b,i,o,!1,null,null,null),P=_.exports},59491:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"userForm",attrs:{"label-width":"150px",model:e.formData,rules:e.rules}},[t("el-form-item",{attrs:{label:"用户类型"}},[t("el-select",{attrs:{disabled:e.isEdit},model:{value:e.formData.pin,callback:function(t){e.$set(e.formData,"pin",t)},expression:"formData.pin"}},e._l(e.userEditList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:1===e.formData.pin?"用户账户":"域账号",prop:"userName",rules:1===e.formData.pin?e.userName:e.mainUserName}},[t("el-input",{attrs:{disabled:e.isEdit,placeholder:"请输入用户账户",autocomplete:"off"},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}})],1),t("el-form-item",{attrs:{label:"用户名称",prop:"userNickname"}},[t("el-input",{attrs:{placeholder:"请输入用户名称",autocomplete:"off"},model:{value:e.formData.userNickname,callback:function(t){e.$set(e.formData,"userNickname",t)},expression:"formData.userNickname"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"mobilePhone"}},[t("el-input",{attrs:{placeholder:"请输入手机号",maxlength:"11",autocomplete:"off"},model:{value:e.formData.mobilePhone,callback:function(t){e.$set(e.formData,"mobilePhone",t)},expression:"formData.mobilePhone"}})],1),t("el-form-item",{attrs:{label:"所属组织",prop:"depUniqueId"}},[t("el-cascader",{attrs:{options:e.depUniqueOptions,"show-all-levels":!1,props:{checkStrictly:!0,value:"uniqueId",label:"departmentName"}},model:{value:e.formData.depUniqueId,callback:function(t){e.$set(e.formData,"depUniqueId",t)},expression:"formData.depUniqueId"}})],1),1===e.formData.pin?[t("el-form-item",{attrs:{label:"邮箱",prop:"mailbox"}},[t("el-input",{attrs:{placeholder:"请输入邮箱",autocomplete:"off"},model:{value:e.formData.mailbox,callback:function(t){e.$set(e.formData,"mailbox",t)},expression:"formData.mailbox"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password",rules:e.passwordRules}},[t("input",{attrs:{type:"text",hidden:""}}),t("input",{attrs:{type:"password",hidden:"",autocomplete:"new-password"}}),t("el-input",{attrs:{placeholder:"请输入密码",autocomplete:"off",type:e.isShowPwd?"string":"password"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}},[t("el-button",{style:{fontSize:"14px",color:e.isShowPwd?"#409EFF":"#ccc"},attrs:{slot:"append",icon:"el-icon-view"},on:{click:function(t){e.isShowPwd=!e.isShowPwd}},slot:"append"})],1)],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-switch",{attrs:{"active-value":1,"inactive-value":2},model:{value:e.formData.state,callback:function(t){e.$set(e.formData,"state",t)},expression:"formData.state"}})],1)]:e._e(),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),t("el-form-item",{attrs:{label:"产品角色"}},[t("product-role",{ref:"role",attrs:{product:e.productList,camPolicy:e.productObj,menu:e.menu}})],1),t("el-form-item",[t("el-button",{on:{click:function(t){return e.$emit("go-back")}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存并返回")])],1)],2)],1)},i=[],o=r(36887),a=r(95669),c=r(46549),s=(r(21703),r(47941),r(38862),r(41539),r(54747),r(21249),r(26699),r(32023),r(98269)),u=r.n(s),l=r(55743),d=r.n(l),p=r(86346),f=r(65461),m=r(33621),h={components:{productRole:p["default"]},inject:["baseIndex"],props:["mode","id","menuId","menu"],data:function(){var e=this;return{password1:"",isShowPwd:!1,formData:{pin:1,state:1},userEditList:[{label:"普通用户",value:1},{label:"域账号用户",value:3}],passwordRules:[{required:"create"===this.mode,message:"请填写密码",trigger:["blur","change"]},{pattern:/^(?=.*[A-Za-z])(?=.*\d)(?=.*[`~!@#$%^&*()_+<>?:"{},.\/\\;'[\]])[A-Za-z\d`~!@#$%^&*()_+<>?:"{},.\/\\;'[\]]{8,}$/,message:"至少8位且必需要有数字+特殊字符+字母",trigger:["blur","change"]},{max:16,message:"密码最长16位",trigger:["blur","change"]}],mainUserName:[{required:!0,message:"请填写域账户",trigger:["blur","change"]},{max:100,message:"域账户最长100位",trigger:["blur","change"]},{type:"email",message:"请填写正确域账户",trigger:"blur"}],userName:[{required:!0,message:"请填写用户账户",trigger:["blur","change"]},{pattern:/^[a-zA-Z0-9]+$/,message:"仅支持26个英文字母和数字0~9；最多32字符",trigger:["blur","change"]},{max:32,message:"用户账户最长32位",trigger:["blur","change"]}],rules:{productUniqueId:[{required:!0,message:"请选择产品",trigger:"change"}],userNickname:[{required:!0,message:"请填写用户名",trigger:["blur","change"]},{max:32,message:"用户名最长32位",trigger:["blur","change"]}],mobilePhone:[{required:!0,message:"请填写手机号码",trigger:"blur"},{trigger:"blur",validator:function(t,r,n){e.$cUtils.validate.isMobile(r)?n():n(new Error("请输入正确的手机号码"))}}],depUniqueId:[{trigger:"change",validator:function(e,t,r){t?r():r(new Error("请选择所属组织！"))}}],mailbox:[{type:"email",message:this.$t("message.emailIncorrect"),trigger:"blur"}]},apiServer:void 0,productList:[],productObj:{},depUniqueOptions:[]}},computed:{isEdit:function(){return"edit"===this.mode}},methods:{depTreeList:function(){var e=this;this.apiServer("depTreeList")().then((function(t){e.depUniqueOptions=t}))},save:function(){var e=this;this.$refs.userForm.validate((function(t){if(t){var r,n,i=JSON.parse(JSON.stringify(e.formData));e.formData.password&&(n=u().stringify(d().parse(e.formData.password)));var o=Array.isArray(i.depUniqueId)?(null===(r=i.depUniqueId)||void 0===r?void 0:r.pop())||"0":i.depUniqueId;e.formData.mobilePhone&&"edit"===e.mode&&(e.formData.mobilePhone=void 0),e.apiServer("edit"===e.mode?"update":3===e.formData.pin?"addaAreaUser":"add")({data:(0,c.Z)((0,c.Z)({},i),{},{password:n,depUniqueId:o,productCamPolicyDtoList:e.$refs.role.getData()})}).then((function(){e.$emit("upsert-end")}))}}))},listByProdUniqueld:function(e){var t=this;return(0,a.Z)((0,o.Z)().mark((function r(){var n;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.apiServer("listByProdUniqueld")({params:{productUniqueId:e}});case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})))()}},mounted:function(){},created:function(){var e=this,t=(0,m.mk)(this),r=t.api;this.apiServer=(0,f.$P)(r),this.apiServer("getProduct")({params:{page:1,pageSize:9999}}).then((function(t){var r=t.list;e.productList=r;var n={};r.forEach((function(t){e.$set(n,t.uniqueId,t)})),"edit"===e.mode&&e.apiServer("detail")({params:{id:e.id}}).then((function(t){var r=JSON.parse(JSON.stringify(t.productCamPolicyDtoList));e.$delete(t,"productCamPolicyDtoList"),e.$set(t,"pin",3!==t.pin?1:3),r.forEach((function(t){var r=t.camPolicyList.map((function(e){return e.id})),i=t.productUniqueId;n[i]&&(e.$set(e.productObj,i,{cname:n[i].cname,uniqueId:i}),e.listByProdUniqueld(i).then((function(t){var n=t.list,o=n.map((function(e){return(0,c.Z)({choice:r.includes(e.id)},e)}));e.$set(e.productObj[i],"role",o)})))})),e.formData=t}))})),this.depTreeList()}},g=h,v=r(1001),y=(0,v.Z)(g,n,i,!1,null,"610c58a8",null),b=y.exports},86346:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});r(26833),r(92222);var n=function(){var e=this,t=e._self._c;return t("div",[Object.values(e.choiceProduct).length?t("div",{staticClass:"choice-role"},[e._l(e.choiceProduct,(function(r,n){return[t("div",{key:n,staticClass:"choice-product",class:r.uniqueId===e.choiceUniqueId?"cur-product":"",on:{click:function(t){e.choiceUniqueId=r.uniqueId}}},[t("span",{staticClass:"product"},[e._v(e._s(r.cname))]),e._l(r.role,(function(r,i){return[r.choice?t("el-tag",{key:"".concat(n,"_").concat(i),staticStyle:{"margin-right":"5px"},attrs:{closable:"",type:"success"},on:{close:function(e){e.stopPropagation(),r.choice=!1}}},[e._v(e._s(r.policyName))]):e._e()]})),t("span",{staticClass:"close el-icon-close",on:{click:function(t){return t.stopPropagation(),e.$delete(e.choiceProduct,n)}}})],2)]})),t("div",{staticClass:"clear"})],2):e._e(),t("div",{staticClass:"product-role"},[t("div",{staticClass:"item"},[t("div",{staticClass:"item-title"},[e._v("产品列表")]),t("el-scrollbar",{staticStyle:{height:"calc(100% - 60px)","margin-top":"10px"}},e._l(e.productList,(function(r,n){return t("div",{key:n,staticClass:"product-list",class:r.uniqueId===e.choiceUniqueId?"cur-product":"",on:{click:function(t){return e.updateProduct(r)}}},[e._v(e._s(r.cname))])})),0)],1),t("div",{staticClass:"item"},[t("div",{staticClass:"item-title"},[e._v("角色列表 "),(e.choiceProduct[e.choiceUniqueId]||{}).cname?t("span",[e._v("("+e._s((e.choiceProduct[e.choiceUniqueId]||{}).cname)+")")]):e._e()]),t("el-scrollbar",{staticStyle:{height:"calc(100% - 60px)","margin-top":"10px"}},[t("div",{staticStyle:{padding:"10px"}},[!e.getRole.length&&(e.choiceProduct[e.choiceUniqueId]||{}).cname?t("el-empty",{attrs:{description:"该产品无角色"}}):e._e(),e._l(e.getRole,(function(r,n){return t("el-button",{key:n,staticStyle:{"margin-bottom":"10px"},attrs:{plain:"",type:r.choice?"primary":"default"},on:{click:function(t){return e.clickRole(r)}}},[e._v(e._s(r.policyName))])}))],2)])],1)])])},i=[],o=(r(47941),r(38862),r(57327),r(41539),r(21249),r(54747),r(57658),r(56414)),a={components:{},props:{product:{type:Array,default:function(){return[]}},menu:{type:Object,default:function(){return{}}},camPolicy:{type:[Array,Object],default:function(){return{}}}},data:function(){return{api:{},choiceProduct:{},choiceRole:[],productList:[],choiceUniqueId:""}},computed:{getRole:function(){return(this.choiceProduct[this.choiceUniqueId]||{}).role||[]}},watch:{product:{handler:function(e){this.productList=JSON.parse(JSON.stringify(e))},deep:!0},camPolicy:{handler:function(e){this.choiceProduct=JSON.parse(JSON.stringify(e))},deep:!0}},methods:{roleChoiceLength:function(e){return(e.role||[]).filter((function(e){return e.choice})).lenght},getData:function(){var e=Object.values(JSON.parse(JSON.stringify(this.choiceProduct))).map((function(e){var t={productUniqueId:e.uniqueId,camPolicyList:[]};return e.role.forEach((function(e){e.choice&&t.camPolicyList.push({policyCode:e.policyCode,policyUniqueId:e.policyUniqueId,id:e.id})})),t}));return e},clickRole:function(e){this.$set(e,"choice",!e.choice)},updateProduct:function(e){var t=this,r=e.uniqueId;this.choiceProduct[r]||(e.role?this.$set(this.choiceProduct,r,{cname:e.cname,uniqueId:r,role:e.role}):(0,o.Z)({url:this.api["listByProdUniqueld"][0],method:this.api["listByProdUniqueld"][1],params:{productUniqueId:r}}).then((function(n){var i=n.data.list;t.$set(e,"role",i),t.$set(t.choiceProduct,r,{cname:e.cname,uniqueId:r,role:i})}))),this.choiceUniqueId=r}},created:function(){this.api=JSON.parse(this.menu.apiJson)}},c=a,s=r(1001),u=(0,s.Z)(c,n,i,!1,null,"1273ccd8",null),l=u.exports},78249:function(e,t,r){(function(t,r){e.exports=r()})(0,(function(){var e=e||function(e,t){var n;if("undefined"!==typeof window&&window.crypto&&(n=window.crypto),"undefined"!==typeof self&&self.crypto&&(n=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!==typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!==typeof r.g&&r.g.crypto&&(n=r.g.crypto),!n)try{n=r(42480)}catch(g){}var i=function(){if(n){if("function"===typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(g){}if("function"===typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(g){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),a={},c=a.lib={},s=c.Base=function(){return{extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),u=c.WordArray=s.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(var c=0;c<i;c+=4)t[n+c>>>2]=r[c>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(i());return new u.init(t,e)}}),l=a.enc={},d=l.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},p=l.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},f=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},m=c.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,o=n.sigBytes,a=this.blockSize,c=4*a,s=o/c;s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0);var l=s*a,d=e.min(4*l,o);if(l){for(var p=0;p<l;p+=a)this._doProcessBlock(i,p);r=i.splice(0,l),n.sigBytes-=d}return new u.init(r,d)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(c.Hasher=m.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new h.HMAC.init(e,r).finalize(t)}}}),a.algo={});return a}(Math);return e}))},98269:function(e,t,r){(function(t,n){e.exports=n(r(78249))})(0,(function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.enc;i.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],o=0;o<r;o+=3)for(var a=t[o>>>2]>>>24-o%4*8&255,c=t[o+1>>>2]>>>24-(o+1)%4*8&255,s=t[o+2>>>2]>>>24-(o+2)%4*8&255,u=a<<16|c<<8|s,l=0;l<4&&o+.75*l<r;l++)i.push(n.charAt(u>>>6*(3-l)&63));var d=n.charAt(64);if(d)while(i.length%4)i.push(d);return i.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var i=0;i<r.length;i++)n[r.charCodeAt(i)]=i}var a=r.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(t=c)}return o(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(e,t,r){for(var i=[],o=0,a=0;a<t;a++)if(a%4){var c=r[e.charCodeAt(a-1)]<<a%4*2,s=r[e.charCodeAt(a)]>>>6-a%4*2,u=c|s;i[o>>>2]|=u<<24-o%4*8,o++}return n.create(i,o)}}(),e.enc.Base64}))},55743:function(e,t,r){(function(t,n){e.exports=n(r(78249))})(0,(function(e){return e.enc.Utf8}))},99534:function(e,t,r){"use strict";r.d(t,{Ch:function(){return u},Dz:function(){return i},JV:function(){return p},SP:function(){return l},Sy:function(){return d},XY:function(){return m},_d:function(){return a},fI:function(){return f},gj:function(){return s},s8:function(){return o},ul:function(){return c}});var n=r(56414);function i(e){return(0,n.Z)({method:"get",url:"auth/business/list",params:e})}function o(e){return(0,n.Z)({method:"get",url:"auth/camPolicy/detail",params:e})}function a(e){return(0,n.Z)({method:"post",url:"auth/camPolicy/save",data:e})}function c(e){return(0,n.Z)({method:"post",url:"auth/camPolicy/update",data:e})}function s(e){return(0,n.Z)({method:"post",url:"auth/camPolicyDataTag/save",data:e})}function u(e){return(0,n.Z)({method:"post",url:"auth/camPolicy/v2/policyDataTagList",data:e})}function l(e){return(0,n.Z)({method:"post",url:"auth/camPolicy/v2/policyDetail",data:e})}function d(e){return(0,n.Z)({method:"post",url:"auth/camPolicy/savePolicy",data:e})}function p(e){return(0,n.Z)({method:"get",url:"auth/camPolicy/list",params:e})}function f(e){return(0,n.Z)({method:"get",url:"auth/user/getUserErrorCount",isJSON:!1,params:e})}function m(e){return(0,n.Z)({method:"post",url:"auth/user/clearCache",isJSON:!1,params:e})}},42480:function(){}}]);